<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>user_interface &#8212; FLRW-Net 2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css?v=0f882399" />
    <script src="../_static/documentation_options.js?v=60dbed4a"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../documentation.html">FLRW-Net 2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">user_interface</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for user_interface</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;This module implements FLRW-Net&#39;s UI.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">font</span><span class="p">,</span> <span class="n">messagebox</span><span class="p">,</span> <span class="n">ttk</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">header</span> <span class="k">as</span> <span class="nn">hdr</span>

<span class="c1"># Assign global variables with default value</span>
<span class="n">LOADED_WEIGHTS</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">TRIANGULATION_VALUE</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">BOUNDARY_VALUE</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">WEIGHTS_VALUE</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">FLRW_CONFIG</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">STEPS_VALUE</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">N1</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">N2</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">N3</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">NTE</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">LAMB</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">EPOCHS</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">LR</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">CLIPNORM</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">INI</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">FIN</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Set default values for the entry fields</span>
<span class="n">DEFAULT_CC</span> <span class="o">=</span> <span class="s2">&quot;0.001&quot;</span>        <span class="c1"># Entry 1: cosmological constant</span>
<span class="n">DEFAULT_EDGE_INI</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>      <span class="c1"># Entry 2: initial boundary</span>
<span class="n">DEFAULT_EDGE_FIN</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>      <span class="c1"># Entry 3: final boundary</span>
<span class="n">DEFAULT_EPOCHS</span> <span class="o">=</span> <span class="s2">&quot;5000&quot;</span>     <span class="c1"># Entry 4: number of EPOCHS</span>
<span class="n">DEFAULT_LR</span> <span class="o">=</span> <span class="s2">&quot;0.001&quot;</span>        <span class="c1"># Entry 5: learning rate</span>
<span class="n">DEFAULT_CLIPNORM</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>      <span class="c1"># Entry 6: CLIPNORM of adam optimizer</span>

<span class="n">UPDATED_CONFIG</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">CHANGED_STEPS</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">LOSS_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-26</span>

<div class="viewcode-block" id="centering_window">
<a class="viewcode-back" href="../user_interface.html#user_interface.centering_window">[docs]</a>
<span class="k">def</span> <span class="nf">centering_window</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Center a specified window on the screen.&quot;&quot;&quot;</span>
    <span class="c1"># Get the screen width and height</span>
    <span class="n">screen_width</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span>
    <span class="n">screen_height</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span>

    <span class="c1"># Calculate the x and y coordinates to center the window</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">screen_width</span> <span class="o">-</span> <span class="n">width</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">screen_height</span> <span class="o">-</span> <span class="n">height</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>

    <span class="c1"># Set the window&#39;s position</span>
    <span class="n">window</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="purpose">
<a class="viewcode-back" href="../user_interface.html#user_interface.purpose">[docs]</a>
<span class="k">def</span> <span class="nf">purpose</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show the purpose of FLRW-Net upon clicking on the according button.&quot;&quot;&quot;</span>
    <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Purpose&quot;</span><span class="p">,</span> <span class="s2">&quot;A machine learning project in Python, using TensorFlow &amp; &quot;</span>
                        <span class="s2">&quot;Keras, to compute the time-evolution of an FLRW universe in Euclidean &quot;</span>
                        <span class="s2">&quot;Regge calculus with discrete time steps.</span><span class="se">\n\n</span><span class="s2">Please specify the task by &quot;</span>
                        <span class="s2">&quot;chosing the number of time steps, the triangulation, the type of your boundary data and, if necessary, whether you want to use custom weights, e.g., weights from an earlier calculation, using the top&quot;</span>
                        <span class="s2">&quot; menu.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="my_copyright">
<a class="viewcode-back" href="../user_interface.html#user_interface.my_copyright">[docs]</a>
<span class="k">def</span> <span class="nf">my_copyright</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show the copyright statement.&quot;&quot;&quot;</span>
    <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Copyright&quot;</span><span class="p">,</span> <span class="s2">&quot;Copyright 2024 Florian Emanuel Hilpert&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="open_link">
<a class="viewcode-back" href="../user_interface.html#user_interface.open_link">[docs]</a>
<span class="k">def</span> <span class="nf">open_link</span><span class="p">(</span><span class="n">window</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open the link in a web browser.&quot;&quot;&quot;</span>
    <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;https://github.com/Hilpertspace/NeuralNetwork-FLRW&quot;</span><span class="p">)</span>
    <span class="n">window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span></div>


<div class="viewcode-block" id="git_message_box">
<a class="viewcode-back" href="../user_interface.html#user_interface.git_message_box">[docs]</a>
<span class="k">def</span> <span class="nf">git_message_box</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show a message box containing the link the the Git project.&quot;&quot;&quot;</span>

    <span class="c1"># Create a Toplevel window for the message box</span>
    <span class="n">message_box</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="n">message_box</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Git project&quot;</span><span class="p">)</span>
    <span class="n">message_box</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
    <span class="n">message_box</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;#FFFFFF&quot;</span><span class="p">)</span> <span class="c1"># &quot;white == #FFFFFF&quot;</span>
    <span class="n">message_box</span><span class="o">.</span><span class="n">resizable</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Set the icon for the application</span>
    <span class="n">message_box</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span><span class="s2">&quot;Icon.ico&quot;</span><span class="p">)</span>

    <span class="c1"># Set the size of the window</span>
    <span class="n">window_width</span> <span class="o">=</span> <span class="mi">350</span>
    <span class="n">window_height</span> <span class="o">=</span> <span class="mi">70</span>

    <span class="n">centering_window</span><span class="p">(</span><span class="n">message_box</span><span class="p">,</span> <span class="n">window_width</span><span class="p">,</span> <span class="n">window_height</span><span class="p">)</span>

    <span class="c1"># Message text</span>
    <span class="n">message</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;The code for this poject is available at:&quot;</span>
              <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">https://github.com/Hilpertspace/NeuralNetwork-FLRW&quot;</span><span class="p">)</span>

    <span class="c1"># Create a font object and configure it for underline on hover</span>
    <span class="n">default_font</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">nametofont</span><span class="p">(</span><span class="s2">&quot;TkDefaultFont&quot;</span><span class="p">)</span>
    <span class="n">underlined_font</span> <span class="o">=</span> <span class="n">default_font</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">underlined_font</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">underline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Create a label as a hyperlink</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">message_box</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                      <span class="n">background</span><span class="o">=</span><span class="s2">&quot;#FFFFFF&quot;</span><span class="p">,</span> <span class="n">cursor</span><span class="o">=</span><span class="s2">&quot;hand2&quot;</span><span class="p">)</span>
    <span class="n">label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Button-1&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="n">open_link</span><span class="p">(</span><span class="n">message_box</span><span class="p">))</span>
    <span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="n">underlined_font</span><span class="p">))</span>
    <span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;Leave&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="n">label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="s2">&quot;TkDefaultFont&quot;</span><span class="p">))</span>

    <span class="c1"># Display the message box</span>
    <span class="n">message_box</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>  <span class="c1"># Make the message box modal</span>
    <span class="n">message_box</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span></div>


<div class="viewcode-block" id="open_documentation">
<a class="viewcode-back" href="../user_interface.html#user_interface.open_documentation">[docs]</a>
<span class="k">def</span> <span class="nf">open_documentation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open the documentation in the user&#39;s default webbrowser.&quot;&quot;&quot;</span>
    <span class="c1"># Define the path to your HTML file</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;docs/_build/html/index.html&quot;</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

    <span class="n">browser</span> <span class="o">=</span> <span class="n">webbrowser</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

    <span class="c1"># Open the HTML file in the default web browser</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;file://</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="save_weights">
<a class="viewcode-back" href="../user_interface.html#user_interface.save_weights">[docs]</a>
<span class="k">def</span> <span class="nf">save_weights</span><span class="p">(</span><span class="n">training_window</span><span class="p">,</span> <span class="n">dialog</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the trained weights of the network to a .json file.&quot;&quot;&quot;</span>
    <span class="c1"># Define file path</span>
    <span class="n">folder_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;Weights&quot;</span>
    <span class="n">folder_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">/</span> <span class="n">filename</span>

    <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;File Exists&quot;</span><span class="p">,</span> <span class="s2">&quot;The file already exists. &quot;</span>
                               <span class="s2">&quot;Please enter a different filename.&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Create a dictionary with a user&#39;s data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;weights&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;weight 1&quot;</span><span class="p">:</span> <span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;weight 2&quot;</span><span class="p">:</span> <span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;weight 3&quot;</span><span class="p">:</span> <span class="n">weights</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>

        <span class="c1"># Write the dictionary to the JSON file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">json_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Success&quot;</span><span class="p">,</span> <span class="s2">&quot;Saved weights.&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="n">training_window</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span></div>


<div class="viewcode-block" id="save_weights_dialog">
<a class="viewcode-back" href="../user_interface.html#user_interface.save_weights_dialog">[docs]</a>
<span class="k">def</span> <span class="nf">save_weights_dialog</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">np_trained_weights</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show saving weights window upon clicking the according button in the training window.&quot;&quot;&quot;</span>

    <span class="c1"># Create a new Toplevel window</span>
    <span class="n">dialog</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>

    <span class="c1"># Configure the dialog window</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Save weights&quot;</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span><span class="s2">&quot;Icon.ico&quot;</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">resizable</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">centering_window</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">deiconify</span><span class="p">()</span>

    <span class="c1"># Create and place the entry widget</span>
    <span class="n">entry_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Enter filename:&quot;</span><span class="p">)</span>
    <span class="n">entry_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">entry_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Create a frame to hold the entry and the label</span>
    <span class="n">entry_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
    <span class="n">entry_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Create and place the entry widget inside the frame</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">entry_frame</span><span class="p">)</span>
    <span class="n">fname</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

    <span class="c1"># Create and place the .json label inside the frame</span>
    <span class="n">json_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">entry_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;.json&quot;</span><span class="p">)</span>
    <span class="n">json_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">json_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

    <span class="c1"># Create and place the submit button</span>
    <span class="n">submit_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span>
                              <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">save_weights</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">dialog</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">np_trained_weights</span><span class="p">))</span>
    <span class="n">submit_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></div>


<div class="viewcode-block" id="save_output">
<a class="viewcode-back" href="../user_interface.html#user_interface.save_output">[docs]</a>
<span class="k">def</span> <span class="nf">save_output</span><span class="p">(</span><span class="n">training_window</span><span class="p">,</span> <span class="n">dialog</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the network&#39;s output to a .json file.&quot;&quot;&quot;</span>
    <span class="c1"># Define file path</span>
    <span class="n">folder_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;Outputs&quot;</span>
    <span class="n">folder_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">/</span> <span class="n">filename</span>

    <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;File Exists&quot;</span><span class="p">,</span> <span class="s2">&quot;The file already exists. &quot;</span>
                               <span class="s2">&quot;Please enter a different filename.&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Create a dictionary with a user&#39;s data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;outputs&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;edge 1&quot;</span><span class="p">:</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;strut 1&quot;</span><span class="p">:</span> <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;edge 2&quot;</span><span class="p">:</span> <span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>

        <span class="c1"># Write the dictionary to the JSON file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">json_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Success&quot;</span><span class="p">,</span> <span class="s2">&quot;Saved output.&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="n">training_window</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span></div>


<div class="viewcode-block" id="save_output_dialog">
<a class="viewcode-back" href="../user_interface.html#user_interface.save_output_dialog">[docs]</a>
<span class="k">def</span> <span class="nf">save_output_dialog</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show saving output window upon clicking the according button in the training window.&quot;&quot;&quot;</span>

    <span class="c1"># Create a new Toplevel window</span>
    <span class="n">dialog</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>

    <span class="c1"># Configure the dialog window</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Save output&quot;</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span><span class="s2">&quot;Icon.ico&quot;</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">resizable</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">centering_window</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">deiconify</span><span class="p">()</span>

    <span class="c1"># Create and place the entry widget</span>
    <span class="n">entry_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Enter filename:&quot;</span><span class="p">)</span>
    <span class="n">entry_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">entry_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Create a frame to hold the entry and the label</span>
    <span class="n">entry_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
    <span class="n">entry_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Create and place the entry widget inside the frame</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">entry_frame</span><span class="p">)</span>
    <span class="n">fname</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

    <span class="c1"># Create and place the .json label inside the frame</span>
    <span class="n">json_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">entry_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;.json&quot;</span><span class="p">)</span>
    <span class="n">json_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">json_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

    <span class="c1"># Create and place the submit button</span>
    <span class="n">submit_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span>
                            <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">save_output</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">dialog</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">output</span><span class="p">))</span>
    <span class="n">submit_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></div>


<div class="viewcode-block" id="save_graph">
<a class="viewcode-back" href="../user_interface.html#user_interface.save_graph">[docs]</a>
<span class="k">def</span> <span class="nf">save_graph</span><span class="p">(</span><span class="n">training_window</span><span class="p">,</span> <span class="n">dialog</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">fig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the graph containing the network&#39;s training behaviour to a .png file.&quot;&quot;&quot;</span>
    <span class="c1"># Define file path</span>
    <span class="n">folder_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;Graphs&quot;</span>
    <span class="n">folder_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">/</span> <span class="n">filename</span>

    <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;File Exists&quot;</span><span class="p">,</span> <span class="s2">&quot;The file already exists. &quot;</span>
                               <span class="s2">&quot;Please enter a different filename.&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Success&quot;</span><span class="p">,</span> <span class="s2">&quot;Saved graph.&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="n">training_window</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span></div>


<div class="viewcode-block" id="save_graph_dialog">
<a class="viewcode-back" href="../user_interface.html#user_interface.save_graph_dialog">[docs]</a>
<span class="k">def</span> <span class="nf">save_graph_dialog</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">fig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show saving graph window upon clicking the according button in the training window.&quot;&quot;&quot;</span>

    <span class="c1"># Create a new Toplevel window</span>
    <span class="n">dialog</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>

    <span class="c1"># Configure the dialog window</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Save graph&quot;</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span><span class="s2">&quot;Icon.ico&quot;</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">resizable</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">centering_window</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">deiconify</span><span class="p">()</span>

    <span class="c1"># Create and place the entry widget</span>
    <span class="n">entry_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Enter filename:&quot;</span><span class="p">)</span>
    <span class="n">entry_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">entry_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Create a frame to hold the entry and the label</span>
    <span class="n">entry_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
    <span class="n">entry_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Create and place the entry widget inside the frame</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">entry_frame</span><span class="p">)</span>
    <span class="n">fname</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

    <span class="c1"># Create and place the .png label inside the frame</span>
    <span class="n">png_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">entry_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;.png&quot;</span><span class="p">)</span>
    <span class="n">png_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">png_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

    <span class="c1"># Create and place the submit button</span>
    <span class="n">submit_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span>
                              <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">save_graph</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">dialog</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">fig</span><span class="p">))</span>
    <span class="n">submit_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></div>


<div class="viewcode-block" id="load_weights">
<a class="viewcode-back" href="../user_interface.html#user_interface.load_weights">[docs]</a>
<span class="k">def</span> <span class="nf">load_weights</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">new_value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load custom initial trainable weights for the network from a specified file.&quot;&quot;&quot;</span>
    <span class="c1"># Create a Path object for the file</span>
    <span class="n">folder_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;Weights&quot;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">/</span> <span class="n">filename</span>

    <span class="c1"># Check if the file exists</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;File not found&quot;</span><span class="p">,</span> <span class="s2">&quot;The file could not be found in the &#39;Weights&#39; &quot;</span>
                               <span class="s2">&quot;directory. Please enter a different filename.&quot;</span><span class="p">)</span>
        <span class="n">window</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Load data from file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="c1"># Get user dictionary from data</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;weights&#39;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="k">global</span> <span class="n">LOADED_WEIGHTS</span>
        <span class="n">LOADED_WEIGHTS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;weight 1&#39;</span><span class="p">]],</span>
            <span class="p">[</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;weight 2&#39;</span><span class="p">]],</span>
            <span class="p">[</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;weight 3&#39;</span><span class="p">]]</span>
        <span class="p">])</span>

        <span class="n">window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Success&quot;</span><span class="p">,</span> <span class="s2">&quot;Loaded custom weights as initial weights.&quot;</span>
                               <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">From now on they are used in every computation, &quot;</span>
                               <span class="s2">&quot;until others are loaded or the default weights are set.&quot;</span><span class="p">)</span>
        <span class="n">update_flrw_config</span><span class="p">(</span><span class="s2">&quot;input3&quot;</span><span class="p">,</span> <span class="n">new_value</span><span class="p">)</span></div>


<div class="viewcode-block" id="load_weights_dialog">
<a class="viewcode-back" href="../user_interface.html#user_interface.load_weights_dialog">[docs]</a>
<span class="k">def</span> <span class="nf">load_weights_dialog</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up load weights dialog window.&quot;&quot;&quot;</span>
    <span class="c1"># Create a new Toplevel window</span>
    <span class="n">dialog</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Load weights&quot;</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span><span class="s2">&quot;Icon.ico&quot;</span><span class="p">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">resizable</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">centering_window</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>

    <span class="c1"># Create and place the entry widget</span>
    <span class="n">entry_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Enter filename:&quot;</span><span class="p">)</span>
    <span class="n">entry_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">entry_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Create a frame to hold the entry and the label</span>
    <span class="n">entry_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
    <span class="n">entry_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Create and place the entry widget inside the frame</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">entry_frame</span><span class="p">)</span>
    <span class="n">fname</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

    <span class="c1"># Create and place the .png label inside the frame</span>
    <span class="n">png_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">entry_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;.json&quot;</span><span class="p">)</span>
    <span class="n">png_label</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">png_label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>

    <span class="c1"># Create and place the load button</span>
    <span class="n">load_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Load&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span>
        <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">load_weights</span><span class="p">(</span><span class="n">dialog</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
    <span class="n">load_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></div>


<div class="viewcode-block" id="set_default_weights">
<a class="viewcode-back" href="../user_interface.html#user_interface.set_default_weights">[docs]</a>
<span class="k">def</span> <span class="nf">set_default_weights</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the network&#39;s initial trainable weights to their default value.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">LOADED_WEIGHTS</span>
    <span class="n">LOADED_WEIGHTS</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Success&quot;</span><span class="p">,</span> <span class="s2">&quot;The initial weights have been set to their default value.&quot;</span>
                        <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">From now on they are used in every computation, &quot;</span>
                        <span class="s2">&quot;until others are loaded.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="config_training_window">
<a class="viewcode-back" href="../user_interface.html#user_interface.config_training_window">[docs]</a>
<span class="k">def</span> <span class="nf">config_training_window</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">output_widget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up the training window.&quot;&quot;&quot;</span>
    <span class="c1"># Configure the window&#39;s properties</span>
    <span class="n">window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Training&quot;</span><span class="p">)</span>
    <span class="n">window</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
    <span class="n">window</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">window</span><span class="o">.</span><span class="n">resizable</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">window</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span><span class="s2">&quot;Icon.ico&quot;</span><span class="p">)</span>

    <span class="c1"># Center the training window on the screen</span>
    <span class="n">centering_window</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">630</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">750</span><span class="p">)</span>

    <span class="c1"># Configure the ScrolledText widget</span>
    <span class="n">output_widget</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">output_widget</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>

    <span class="c1"># Redirect the output to the ScrolledText widget</span>
    <span class="n">hdr</span><span class="o">.</span><span class="n">redirect_output_to_widget</span><span class="p">(</span><span class="n">output_widget</span><span class="p">)</span>

    <span class="c1"># Set disabled buttons during training</span>
    <span class="n">save_weights_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save weights&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
    <span class="n">save_weights_btn</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">save_weights_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span>

    <span class="n">save_output_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save output&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
    <span class="n">save_output_btn</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">save_output_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span>

    <span class="n">save_graph_btn</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save graph&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
    <span class="n">save_graph_btn</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">save_graph_btn</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="loading">
<a class="viewcode-back" href="../user_interface.html#user_interface.loading">[docs]</a>
<span class="k">def</span> <span class="nf">loading</span><span class="p">(</span><span class="n">loading_window</span><span class="p">,</span> <span class="n">root_window</span><span class="p">,</span> <span class="n">progress_bar</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate a loading at startup with a ttk progress bar.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">:</span>
        <span class="c1"># Update the progress bar and the loading window</span>
        <span class="n">progress_bar</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">loading_window</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span>

        <span class="c1"># Schedule next iteration of load</span>
        <span class="n">loading_window</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">loading</span><span class="p">,</span> <span class="n">loading_window</span><span class="p">,</span> <span class="n">root_window</span><span class="p">,</span> <span class="n">progress_bar</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Close the loading window after loading completes</span>
        <span class="n">loading_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

        <span class="c1"># Make root window visible again</span>
        <span class="n">root_window</span><span class="o">.</span><span class="n">deiconify</span><span class="p">()</span></div>


<div class="viewcode-block" id="startup_loading_window">
<a class="viewcode-back" href="../user_interface.html#user_interface.startup_loading_window">[docs]</a>
<span class="k">def</span> <span class="nf">startup_loading_window</span><span class="p">(</span><span class="n">root_window</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up the startup loading window.&quot;&quot;&quot;</span>

    <span class="n">load_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">()</span>
    <span class="n">load_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Loading...&quot;</span><span class="p">)</span>
    <span class="n">load_window</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
    <span class="n">load_window</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-topmost&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">load_window</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">load_window</span><span class="o">.</span><span class="n">resizable</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Set the icon for the application</span>
    <span class="n">load_window</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span><span class="s2">&quot;Icon.ico&quot;</span><span class="p">)</span>

    <span class="c1"># Call the centering_window function to center the window</span>
    <span class="n">centering_window</span><span class="p">(</span><span class="n">load_window</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>

    <span class="c1"># Create a progress bar</span>
    <span class="n">progress</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Progressbar</span><span class="p">(</span><span class="n">load_window</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;determinate&quot;</span><span class="p">)</span>
    <span class="n">progress</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pady</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="c1"># Simulate the loading process</span>
    <span class="n">loading</span><span class="p">(</span><span class="n">load_window</span><span class="p">,</span> <span class="n">root_window</span><span class="p">,</span> <span class="n">progress</span><span class="p">)</span></div>


<div class="viewcode-block" id="update_flrw_config">
<a class="viewcode-back" href="../user_interface.html#user_interface.update_flrw_config">[docs]</a>
<span class="k">def</span> <span class="nf">update_flrw_config</span><span class="p">(</span><span class="n">input_type</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the label on the root window showing the current config of FLRW-Net.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">STEPS_VALUE</span>

    <span class="k">if</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;input1&quot;</span><span class="p">:</span>
        <span class="n">TRIANGULATION_VALUE</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;input2&quot;</span><span class="p">:</span>
        <span class="n">BOUNDARY_VALUE</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;input3&quot;</span><span class="p">:</span>
        <span class="n">WEIGHTS_VALUE</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="n">FLRW_CONFIG</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;You want to compute </span><span class="si">{</span><span class="n">STEPS_VALUE</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="si">}</span><span class="s2"> for the &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TRIANGULATION_VALUE</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="si">}</span><span class="s2"> model</span><span class="se">\n</span><span class="s2"> and to prescribe </span><span class="si">{</span><span class="n">BOUNDARY_VALUE</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;as boundary data using </span><span class="si">{</span><span class="n">WEIGHTS_VALUE</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="si">}</span><span class="s2"> weights.&quot;</span><span class="p">)</span>

    <span class="k">global</span> <span class="n">UPDATED_CONFIG</span>
    <span class="n">UPDATED_CONFIG</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="default_weights_chosen">
<a class="viewcode-back" href="../user_interface.html#user_interface.default_weights_chosen">[docs]</a>
<span class="k">def</span> <span class="nf">default_weights_chosen</span><span class="p">(</span><span class="n">new_value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Default the trainable weights initially used by the network.&quot;&quot;&quot;</span>
    <span class="n">set_default_weights</span><span class="p">()</span>
    <span class="n">update_flrw_config</span><span class="p">(</span><span class="s2">&quot;input3&quot;</span><span class="p">,</span> <span class="n">new_value</span><span class="p">)</span></div>


<span class="c1"># Function to update the button&#39;s event function</span>
<div class="viewcode-block" id="update_button_command">
<a class="viewcode-back" href="../user_interface.html#user_interface.update_button_command">[docs]</a>
<span class="k">def</span> <span class="nf">update_button_command</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">button</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">DEFAULT_CC</span><span class="p">,</span> <span class="n">DEFAULT_LR</span><span class="p">,</span> <span class="n">DEFAULT_CLIPNORM</span><span class="p">,</span> <span class="n">UPDATED_CONFIG</span><span class="p">,</span> <span class="n">CHANGED_STEPS</span><span class="p">,</span> <span class="n">STEPS_VALUE</span>

    <span class="c1">#Avoid circular imports</span>
    <span class="kn">from</span> <span class="nn">OneStep.solver_routine</span> <span class="kn">import</span> <span class="n">run_FLRW_Net</span> <span class="k">as</span> <span class="n">run_FLRW_Net_1</span>
    <span class="kn">from</span> <span class="nn">TwoStep.solver_routine</span> <span class="kn">import</span> <span class="n">run_FLRW_Net</span> <span class="k">as</span> <span class="n">run_FLRW_Net_2</span>
    <span class="kn">from</span> <span class="nn">ThreeStep.solver_routine</span> <span class="kn">import</span> <span class="n">run_FLRW_Net</span> <span class="k">as</span> <span class="n">run_FLRW_Net_3</span>
    <span class="kn">from</span> <span class="nn">FourStep.solver_routine</span> <span class="kn">import</span> <span class="n">run_FLRW_Net</span> <span class="k">as</span> <span class="n">run_FLRW_Net_4</span>

    <span class="k">if</span> <span class="n">STEPS_VALUE</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&lt;choose...&gt;&quot;</span><span class="p">:</span>
        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Changed number of steps&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Cosmological constant, learning rate and clipnorm have &quot;</span> <span class="o">+</span>
            <span class="s2">&quot;been set to new default values.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">time_steps</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">DEFAULT_CC</span> <span class="o">=</span> <span class="s2">&quot;0.001&quot;</span>
        <span class="n">DEFAULT_LR</span> <span class="o">=</span> <span class="s2">&quot;0.001&quot;</span>
        <span class="n">DEFAULT_CLIPNORM</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
        <span class="n">STEPS_VALUE</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;a single timestep&quot;</span><span class="p">)</span>
        <span class="n">button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">run_FLRW_Net_1</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">N1</span><span class="p">,</span> <span class="n">N3</span><span class="p">,</span> <span class="n">NTE</span><span class="p">,</span> <span class="n">LAMB</span><span class="p">,</span> <span class="n">EPOCHS</span><span class="p">,</span>
                                            <span class="n">LR</span><span class="p">,</span> <span class="n">CLIPNORM</span><span class="p">,</span> <span class="n">LOADED_WEIGHTS</span><span class="p">,</span> <span class="n">INI</span><span class="p">,</span> <span class="n">FIN</span><span class="p">,</span> <span class="n">LOSS_THRESHOLD</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">time_steps</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">DEFAULT_CC</span> <span class="o">=</span> <span class="s2">&quot;1e-10&quot;</span>
        <span class="n">DEFAULT_LR</span> <span class="o">=</span> <span class="s2">&quot;1e-6&quot;</span>
        <span class="n">DEFAULT_CLIPNORM</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>
        <span class="n">STEPS_VALUE</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;two timesteps&quot;</span><span class="p">)</span>
        <span class="n">button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">run_FLRW_Net_2</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">N1</span><span class="p">,</span> <span class="n">N2</span><span class="p">,</span> <span class="n">N3</span><span class="p">,</span> <span class="n">NTE</span><span class="p">,</span> <span class="n">LAMB</span><span class="p">,</span> <span class="n">EPOCHS</span><span class="p">,</span>
                                            <span class="n">LR</span><span class="p">,</span> <span class="n">CLIPNORM</span><span class="p">,</span> <span class="n">LOADED_WEIGHTS</span><span class="p">,</span> <span class="n">INI</span><span class="p">,</span> <span class="n">FIN</span><span class="p">,</span> <span class="n">LOSS_THRESHOLD</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">))</span>
        
    <span class="k">elif</span> <span class="n">time_steps</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">DEFAULT_CC</span> <span class="o">=</span> <span class="s2">&quot;1e-10&quot;</span>
        <span class="n">DEFAULT_LR</span> <span class="o">=</span> <span class="s2">&quot;1e-5&quot;</span>
        <span class="n">DEFAULT_CLIPNORM</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
        <span class="n">STEPS_VALUE</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;three timesteps&quot;</span><span class="p">)</span>
        <span class="n">button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">run_FLRW_Net_3</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">N1</span><span class="p">,</span> <span class="n">N2</span><span class="p">,</span> <span class="n">N3</span><span class="p">,</span> <span class="n">NTE</span><span class="p">,</span> <span class="n">LAMB</span><span class="p">,</span> <span class="n">EPOCHS</span><span class="p">,</span>
                                            <span class="n">LR</span><span class="p">,</span> <span class="n">CLIPNORM</span><span class="p">,</span> <span class="n">LOADED_WEIGHTS</span><span class="p">,</span> <span class="n">INI</span><span class="p">,</span> <span class="n">FIN</span><span class="p">,</span> <span class="n">LOSS_THRESHOLD</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">))</span>
        
    <span class="k">elif</span> <span class="n">time_steps</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">DEFAULT_CC</span> <span class="o">=</span> <span class="s2">&quot;1e-10&quot;</span>
        <span class="n">DEFAULT_LR</span> <span class="o">=</span> <span class="s2">&quot;1e-5&quot;</span>
        <span class="n">DEFAULT_CLIPNORM</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
        <span class="n">STEPS_VALUE</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;four timesteps&quot;</span><span class="p">)</span>
        <span class="n">button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">run_FLRW_Net_4</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">N1</span><span class="p">,</span> <span class="n">N2</span><span class="p">,</span> <span class="n">N3</span><span class="p">,</span> <span class="n">NTE</span><span class="p">,</span> <span class="n">LAMB</span><span class="p">,</span> <span class="n">EPOCHS</span><span class="p">,</span>
                                            <span class="n">LR</span><span class="p">,</span> <span class="n">CLIPNORM</span><span class="p">,</span> <span class="n">LOADED_WEIGHTS</span><span class="p">,</span> <span class="n">INI</span><span class="p">,</span> <span class="n">FIN</span><span class="p">,</span> <span class="n">LOSS_THRESHOLD</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">))</span>
        
    <span class="n">UPDATED_CONFIG</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">CHANGED_STEPS</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="n">update_flrw_config</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>


<div class="viewcode-block" id="create_triangulation_menu">
<a class="viewcode-back" href="../user_interface.html#user_interface.create_triangulation_menu">[docs]</a>
<span class="k">def</span> <span class="nf">create_triangulation_menu</span><span class="p">(</span><span class="n">menubar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a menu to choose the triangulation of the spatial hypersurfaces.&quot;&quot;&quot;</span>
    <span class="n">task_menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">menubar</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">task_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;5-cell&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">update_flrw_config</span><span class="p">(</span><span class="s2">&quot;input1&quot;</span><span class="p">,</span> <span class="s2">&quot;5-cell&quot;</span><span class="p">))</span>
    <span class="n">task_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;16-cell&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">update_flrw_config</span><span class="p">(</span><span class="s2">&quot;input1&quot;</span><span class="p">,</span> <span class="s2">&quot;16-cell&quot;</span><span class="p">))</span>
    <span class="n">task_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;600-cell&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span><span class="n">update_flrw_config</span><span class="p">(</span><span class="s2">&quot;input1&quot;</span><span class="p">,</span><span class="s2">&quot;600-cell&quot;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">task_menu</span></div>


<div class="viewcode-block" id="create_boundary_menu">
<a class="viewcode-back" href="../user_interface.html#user_interface.create_boundary_menu">[docs]</a>
<span class="k">def</span> <span class="nf">create_boundary_menu</span><span class="p">(</span><span class="n">menubar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a menu to choose the type of boundary data used: edge lengths or scale factors.&quot;&quot;&quot;</span>
    <span class="n">boundary_menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">menubar</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">boundary_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Edge lengths&quot;</span><span class="p">,</span>
        <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">update_flrw_config</span><span class="p">(</span><span class="s2">&quot;input2&quot;</span><span class="p">,</span> <span class="s2">&quot;edge lengths&quot;</span><span class="p">))</span>
    <span class="n">boundary_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Scale factors&quot;</span><span class="p">,</span>
        <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">update_flrw_config</span><span class="p">(</span><span class="s2">&quot;input2&quot;</span><span class="p">,</span> <span class="s2">&quot;scale factors&quot;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">boundary_menu</span></div>


<div class="viewcode-block" id="create_weights_menu">
<a class="viewcode-back" href="../user_interface.html#user_interface.create_weights_menu">[docs]</a>
<span class="k">def</span> <span class="nf">create_weights_menu</span><span class="p">(</span><span class="n">root_window</span><span class="p">,</span> <span class="n">menubar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a menu to allow the user to choose custom/pre-trained weights,</span>
<span class="sd">    which the network uses initially as its trainable weights.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">weights_menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">menubar</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">weights_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Set default weights&quot;</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">default_weights_chosen</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">))</span>
    <span class="n">weights_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Load weights&quot;</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">load_weights_dialog</span><span class="p">(</span><span class="n">root_window</span><span class="p">,</span> <span class="s2">&quot;custom&quot;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">weights_menu</span></div>


<div class="viewcode-block" id="create_help_menu">
<a class="viewcode-back" href="../user_interface.html#user_interface.create_help_menu">[docs]</a>
<span class="k">def</span> <span class="nf">create_help_menu</span><span class="p">(</span><span class="n">root_window</span><span class="p">,</span> <span class="n">menubar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a menu containing misc features that inform and help the user.&quot;&quot;&quot;</span>
    <span class="n">help_menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">menubar</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">help_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Purpose&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">purpose</span><span class="p">)</span>
    <span class="n">help_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Documentation&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">open_documentation</span><span class="p">())</span>
    <span class="n">help_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Copyright&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">my_copyright</span><span class="p">)</span>
    <span class="n">help_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Git project&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">git_message_box</span><span class="p">(</span><span class="n">root_window</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">help_menu</span></div>


<div class="viewcode-block" id="set_threshold">
<a class="viewcode-back" href="../user_interface.html#user_interface.set_threshold">[docs]</a>
<span class="k">def</span> <span class="nf">set_threshold</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the value for the global loss threshold.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">LOSS_THRESHOLD</span>

    <span class="k">if</span> <span class="n">string</span> <span class="o">==</span> <span class="s2">&quot;1e-20&quot;</span><span class="p">:</span>
        <span class="n">LOSS_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-20</span>
    <span class="k">elif</span> <span class="n">string</span> <span class="o">==</span> <span class="s2">&quot;1e-21&quot;</span><span class="p">:</span>
        <span class="n">LOSS_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-21</span>
    <span class="k">elif</span> <span class="n">string</span> <span class="o">==</span> <span class="s2">&quot;1e-22&quot;</span><span class="p">:</span>
        <span class="n">LOSS_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-22</span>
    <span class="k">elif</span> <span class="n">string</span> <span class="o">==</span> <span class="s2">&quot;1e-23&quot;</span><span class="p">:</span>
        <span class="n">LOSS_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-23</span>
    <span class="k">elif</span> <span class="n">string</span> <span class="o">==</span> <span class="s2">&quot;1e-24&quot;</span><span class="p">:</span>
        <span class="n">LOSS_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-24</span>
    <span class="k">elif</span> <span class="n">string</span> <span class="o">==</span> <span class="s2">&quot;1e-25&quot;</span><span class="p">:</span>
        <span class="n">LOSS_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-25</span>
    <span class="k">elif</span> <span class="n">string</span> <span class="o">==</span> <span class="s2">&quot;1e-26&quot;</span><span class="p">:</span>
        <span class="n">LOSS_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-26</span>
    <span class="k">elif</span> <span class="n">string</span> <span class="o">==</span> <span class="s2">&quot;1e-27&quot;</span><span class="p">:</span>
        <span class="n">LOSS_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-27</span>
    <span class="k">elif</span> <span class="n">string</span> <span class="o">==</span> <span class="s2">&quot;1e-28&quot;</span><span class="p">:</span>
        <span class="n">LOSS_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-28</span>

    <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The threshold for the loss has been set to </span><span class="si">{</span><span class="n">LOSS_THRESHOLD</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="create_threshold_menu">
<a class="viewcode-back" href="../user_interface.html#user_interface.create_threshold_menu">[docs]</a>
<span class="k">def</span> <span class="nf">create_threshold_menu</span><span class="p">(</span><span class="n">menubar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a menu to allow the user to choose different thresholds for the loss.&quot;&quot;&quot;</span>
    <span class="n">threshold_menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">menubar</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">threshold_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;1e-20&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">set_threshold</span><span class="p">(</span><span class="s2">&quot;1e-20&quot;</span><span class="p">))</span>
    <span class="n">threshold_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;1e-21&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">set_threshold</span><span class="p">(</span><span class="s2">&quot;1e-21&quot;</span><span class="p">))</span>
    <span class="n">threshold_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;1e-22&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">set_threshold</span><span class="p">(</span><span class="s2">&quot;1e-22&quot;</span><span class="p">))</span>
    <span class="n">threshold_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;1e-23&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">set_threshold</span><span class="p">(</span><span class="s2">&quot;1e-23&quot;</span><span class="p">))</span>
    <span class="n">threshold_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;1e-24&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">set_threshold</span><span class="p">(</span><span class="s2">&quot;1e-24&quot;</span><span class="p">))</span>
    <span class="n">threshold_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;1e-25&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">set_threshold</span><span class="p">(</span><span class="s2">&quot;1e-25&quot;</span><span class="p">))</span>
    <span class="n">threshold_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;1e-26&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">set_threshold</span><span class="p">(</span><span class="s2">&quot;1e-26&quot;</span><span class="p">))</span>
    <span class="n">threshold_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;1e-27&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">set_threshold</span><span class="p">(</span><span class="s2">&quot;1e-27&quot;</span><span class="p">))</span>
    <span class="n">threshold_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;1e-28&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">set_threshold</span><span class="p">(</span><span class="s2">&quot;1e-28&quot;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">threshold_menu</span></div>


<div class="viewcode-block" id="on_closing_root_window">
<a class="viewcode-back" href="../user_interface.html#user_interface.on_closing_root_window">[docs]</a>
<span class="k">def</span> <span class="nf">on_closing_root_window</span><span class="p">(</span><span class="n">root_window</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set closing dialog.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">messagebox</span><span class="o">.</span><span class="n">askyesno</span><span class="p">(</span><span class="s2">&quot;Quit&quot;</span><span class="p">,</span> <span class="s2">&quot;Do you really want to quit FLRW-Net&#39;s user interface?&quot;</span><span class="p">):</span>

        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Goodbye&quot;</span><span class="p">,</span> <span class="s2">&quot;Hope to see you soon :)&quot;</span><span class="p">)</span>
        <span class="n">root_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span></div>


<div class="viewcode-block" id="run_user_interface">
<a class="viewcode-back" href="../user_interface.html#user_interface.run_user_interface">[docs]</a>
<span class="k">def</span> <span class="nf">run_user_interface</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specify the UI&#39;s windows and features.&quot;&quot;&quot;</span>

    <span class="c1"># Generate the root window and make it invisible</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
    <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>

    <span class="c1"># Bind the close window event if nothing happended.</span>
    <span class="c1"># Upon closing the root window ask whether FLRW-Net&#39;s UI should really be closed.</span>
    <span class="n">root</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s2">&quot;WM_DELETE_WINDOW&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">on_closing_root_window</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>

    <span class="c1"># Set global parameters to adjust the FLRW_CONFIG label text properly</span>
    <span class="k">global</span> <span class="n">TRIANGULATION_VALUE</span><span class="p">,</span> <span class="n">BOUNDARY_VALUE</span><span class="p">,</span> <span class="n">WEIGHTS_VALUE</span><span class="p">,</span> <span class="n">FLRW_CONFIG</span><span class="p">,</span> <span class="n">STEPS_VALUE</span>
    <span class="n">TRIANGULATION_VALUE</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
    <span class="n">TRIANGULATION_VALUE</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;&lt;choose...&gt;&quot;</span><span class="p">)</span>
    <span class="n">BOUNDARY_VALUE</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
    <span class="n">BOUNDARY_VALUE</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;&lt;choose...&gt;&quot;</span><span class="p">)</span>
    <span class="n">WEIGHTS_VALUE</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
    <span class="n">WEIGHTS_VALUE</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
    <span class="n">STEPS_VALUE</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
    <span class="n">STEPS_VALUE</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;&lt;choose...&gt;&quot;</span><span class="p">)</span>

    <span class="c1"># Set a visible statement on the root window how FLRW-Net is currently configured</span>
    <span class="n">FLRW_CONFIG</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;You want to compute </span><span class="si">{</span><span class="n">STEPS_VALUE</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="si">}</span><span class="s2"> for the &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TRIANGULATION_VALUE</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="si">}</span><span class="s2"> model</span><span class="se">\n</span><span class="s2"> and to prescribe </span><span class="si">{</span><span class="n">BOUNDARY_VALUE</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="si">}</span><span class="s2"> as&quot;</span>
        <span class="sa">f</span><span class="s2">&quot; boundary data using </span><span class="si">{</span><span class="n">WEIGHTS_VALUE</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="si">}</span><span class="s2"> weights.&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

    <span class="c1"># Configure the statement</span>
    <span class="n">FLRW_CONFIG</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>

    <span class="c1"># Simulate a loading at startup with a progress bar in a separate window.</span>
    <span class="c1"># Further code is executed in the meanwhile.</span>
    <span class="n">startup_loading_window</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_timesteps_menu</span><span class="p">(</span><span class="n">menubar</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a menu to choose the type of boundary data used: edge lengths or scale factors.&quot;&quot;&quot;</span>
        <span class="n">timesteps_menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">menubar</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">timesteps_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;1 step&quot;</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">update_button_command</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">timesteps_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;2 steps&quot;</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">update_button_command</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">timesteps_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;3 steps&quot;</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">update_button_command</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">timesteps_menu</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;4 steps&quot;</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">update_button_command</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">timesteps_menu</span>
    
    <span class="k">def</span> <span class="nf">create_menubar</span><span class="p">(</span><span class="n">root_window</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a menubar for the root window.&quot;&quot;&quot;</span>
        <span class="n">menu_bar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">root_window</span><span class="p">)</span>

        <span class="c1"># Create separate menus</span>
        <span class="n">triangulation_menu</span> <span class="o">=</span> <span class="n">create_triangulation_menu</span><span class="p">(</span><span class="n">menu_bar</span><span class="p">)</span>
        <span class="n">boundary_menu</span> <span class="o">=</span> <span class="n">create_boundary_menu</span><span class="p">(</span><span class="n">menu_bar</span><span class="p">)</span>
        <span class="n">timesteps_menu</span> <span class="o">=</span> <span class="n">create_timesteps_menu</span><span class="p">(</span><span class="n">menu_bar</span><span class="p">)</span>
        <span class="n">weights_menu</span> <span class="o">=</span> <span class="n">create_weights_menu</span><span class="p">(</span><span class="n">root_window</span><span class="p">,</span> <span class="n">menu_bar</span><span class="p">)</span>
        <span class="n">threshold_menu</span> <span class="o">=</span> <span class="n">create_threshold_menu</span><span class="p">(</span><span class="n">menu_bar</span><span class="p">)</span>
        <span class="n">help_menu</span> <span class="o">=</span> <span class="n">create_help_menu</span><span class="p">(</span><span class="n">root_window</span><span class="p">,</span> <span class="n">menu_bar</span><span class="p">)</span>

        <span class="c1"># Add menus to the menu bar</span>
        <span class="n">menu_bar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Time steps&quot;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">timesteps_menu</span><span class="p">)</span>
        <span class="n">menu_bar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Triangulation&quot;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">triangulation_menu</span><span class="p">)</span>
        <span class="n">menu_bar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Boundary data&quot;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">boundary_menu</span><span class="p">)</span>
        <span class="n">menu_bar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Weights&quot;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">weights_menu</span><span class="p">)</span>
        <span class="n">menu_bar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Loss threshold&quot;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">threshold_menu</span><span class="p">)</span>
        <span class="n">menu_bar</span><span class="o">.</span><span class="n">add_cascade</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Help&quot;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">help_menu</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">menu_bar</span>

    <span class="c1"># Create a menubar for the root window</span>
    <span class="n">menubar</span> <span class="o">=</span> <span class="n">create_menubar</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

    <span class="c1"># Configure the root window</span>
    <span class="n">root</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;FLRW-Net&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
    <span class="n">root</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">menubar</span><span class="p">)</span>
    <span class="n">root</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span><span class="s2">&quot;Icon.ico&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="o">.</span><span class="n">resizable</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Center the root window on the screen</span>
    <span class="n">centering_window</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">230</span><span class="p">)</span>

    <span class="c1"># Ensure that the default weights are set initially</span>
    <span class="k">global</span> <span class="n">LOADED_WEIGHTS</span>
    <span class="n">LOADED_WEIGHTS</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">on_entry1_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the placeholder text when the cosmological constant entry widget is clicked.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">entry1</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="n">DEFAULT_CC</span><span class="p">:</span>
            <span class="n">entry1</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
            <span class="n">entry1</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

        <span class="c1"># Disable the compute button upon changing the parameters.</span>
        <span class="n">compute_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_focus_out1</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restore the placeholder text when the cosmological constant entry widget loses focus.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">entry1</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">entry1</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_CC</span><span class="p">)</span>
            <span class="n">entry1</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_entry2_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the placeholder text when the initial boundary entry widget is clicked.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">entry2</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="n">DEFAULT_EDGE_INI</span><span class="p">:</span>
            <span class="n">entry2</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
            <span class="n">entry2</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

        <span class="c1"># Disable the compute button upon changing the parameters.</span>
        <span class="n">compute_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_focus_out2</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restore the placeholder text when the initial boundary entry widget loses focus.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">entry2</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">entry2</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_EDGE_INI</span><span class="p">)</span>
            <span class="n">entry2</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_entry3_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the placeholder text when the final boundary entry widget is clicked.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">entry3</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="n">DEFAULT_EDGE_FIN</span><span class="p">:</span>
            <span class="n">entry3</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
            <span class="n">entry3</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

        <span class="c1"># Disable the compute button upon changing the parameters.</span>
        <span class="n">compute_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_focus_out3</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restore the placeholder text when the final boundary entry widget loses focus.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">entry3</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">entry3</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_EDGE_FIN</span><span class="p">)</span>
            <span class="n">entry3</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_entry4_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the placeholder text when the EPOCHS entry widget is clicked.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">entry4</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="n">DEFAULT_EPOCHS</span><span class="p">:</span>
            <span class="n">entry4</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
            <span class="n">entry4</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

        <span class="c1"># Disable the compute button upon changing the parameters.</span>
        <span class="n">compute_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_focus_out4</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restore the placeholder text when the EPOCHS entry widget loses focus.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">entry4</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">entry4</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_EPOCHS</span><span class="p">)</span>
            <span class="n">entry4</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_entry5_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the placeholder text when the learning rate entry widget is clicked.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">entry5</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="n">DEFAULT_LR</span><span class="p">:</span>
            <span class="n">entry5</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
            <span class="n">entry5</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

        <span class="c1"># Disable the compute button upon changing the parameters.</span>
        <span class="n">compute_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_focus_out5</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restore the placeholder text when the learning rate entry widget loses focus.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">entry5</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">entry5</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_LR</span><span class="p">)</span>
            <span class="n">entry5</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_entry6_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the placeholder text when the CLIPNORM entry widget is clicked.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">entry6</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="n">DEFAULT_CLIPNORM</span><span class="p">:</span>
            <span class="n">entry6</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
            <span class="n">entry6</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

        <span class="c1"># Disable the compute button upon changing the parameters.</span>
        <span class="n">compute_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_focus_out6</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restore the placeholder text when the CLIPNORM entry widget loses focus.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">entry6</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">entry6</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_CLIPNORM</span><span class="p">)</span>
            <span class="n">entry6</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">fg</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">validate_entries</span><span class="p">(</span><span class="n">entry1</span><span class="p">,</span> <span class="n">entry2</span><span class="p">,</span> <span class="n">entry3</span><span class="p">,</span> <span class="n">entry4</span><span class="p">,</span> <span class="n">entry5</span><span class="p">,</span> <span class="n">entry6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check whether the entry fields only contain numbers.&quot;&quot;&quot;</span>
        <span class="c1"># Check the entry field for the cosmological constant</span>
        <span class="k">if</span> <span class="n">entry1</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">test1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry1</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">test1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span>
                <span class="s2">&quot;The value for the cosmological constant must not be negative!&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span>
                <span class="s2">&quot;The value for the cosmological constant is not numeric!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check the entry field for the initial boundary</span>
        <span class="k">if</span> <span class="n">entry2</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">test2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry2</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">test2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span>
                <span class="s2">&quot;The value for the initial boundary must not be negative!&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;The value for the initial boundary is not numeric!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check the entry field for the final boundary</span>
        <span class="k">if</span> <span class="n">entry3</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">test3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry3</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">test3</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">test3</span> <span class="o">==</span> <span class="n">test2</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;The value for the final boundary &quot;</span>
                <span class="s2">&quot;must neither be negative nor must it match the value for the initial boundary!&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;The value for the final boundary is not numeric!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check the entry field for the EPOCHS</span>
        <span class="k">if</span> <span class="n">entry4</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">test4</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry4</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">test4</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;You must at least train for one epoch!&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;The value for the EPOCHS is not numeric!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check the entry field for the learning rate</span>
        <span class="k">if</span> <span class="n">entry5</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">test5</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry5</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">test5</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span>
                <span class="s2">&quot;The value for the learning rate must be positive!&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;The value for the learning rate is not numeric!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check the entry field for the CLIPNORM</span>
        <span class="k">if</span> <span class="n">entry6</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">test6</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry6</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">test6</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">test6</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span>
                <span class="s2">&quot;The value for the CLIPNORM must be positive and smaller than 2&quot;</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">(Experimental upper limit: still subject to change.)!&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;The value for the CLIPNORM is not numeric!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">confirm_choices</span><span class="p">(</span><span class="n">triangulation</span><span class="p">,</span> <span class="n">boundary</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">,</span>
                        <span class="n">entry1</span><span class="p">,</span> <span class="n">entry2</span><span class="p">,</span> <span class="n">entry3</span><span class="p">,</span> <span class="n">entry4</span><span class="p">,</span> <span class="n">entry5</span><span class="p">,</span> <span class="n">entry6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Store the entries, set up all computation params and enable the compute button.&quot;&quot;&quot;</span>

        <span class="c1"># Set all model and training parameters to be global vars</span>
        <span class="k">global</span> <span class="n">N1</span><span class="p">,</span> <span class="n">N2</span><span class="p">,</span> <span class="n">N3</span><span class="p">,</span> <span class="n">NTE</span><span class="p">,</span> <span class="n">LAMB</span><span class="p">,</span> <span class="n">EPOCHS</span><span class="p">,</span> <span class="n">LR</span><span class="p">,</span> <span class="n">CLIPNORM</span><span class="p">,</span> <span class="n">INI</span><span class="p">,</span> <span class="n">FIN</span>

        <span class="c1"># Take the focus from the entry fields and set it to the root window.</span>
        <span class="n">root</span><span class="o">.</span><span class="n">focus</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">validate_entries</span><span class="p">(</span><span class="n">entry1</span><span class="p">,</span> <span class="n">entry2</span><span class="p">,</span> <span class="n">entry3</span><span class="p">,</span> <span class="n">entry4</span><span class="p">,</span> <span class="n">entry5</span><span class="p">,</span> <span class="n">entry6</span><span class="p">):</span>
            <span class="c1"># Set triangulation parameters</span>
            <span class="n">N1</span><span class="p">,</span> <span class="n">N2</span><span class="p">,</span> <span class="n">N3</span><span class="p">,</span> <span class="n">NTE</span><span class="p">,</span><span class="n">triangulation_warning</span><span class="o">=</span><span class="n">hdr</span><span class="o">.</span><span class="n">set_triangulation_params</span><span class="p">(</span><span class="n">triangulation</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

            <span class="c1"># Set boundary parameters</span>
            <span class="n">INI</span><span class="p">,</span> <span class="n">FIN</span><span class="p">,</span> <span class="n">boundary_warning</span> <span class="o">=</span> <span class="n">hdr</span><span class="o">.</span><span class="n">set_boundary_params</span><span class="p">(</span><span class="n">boundary</span><span class="p">,</span> <span class="n">entry2</span><span class="p">,</span> <span class="n">entry3</span><span class="p">,</span> <span class="n">N3</span><span class="p">)</span>

            <span class="c1"># Handle the different warnings</span>
            <span class="n">LAMB</span><span class="p">,</span> <span class="n">EPOCHS</span><span class="p">,</span> <span class="n">LR</span><span class="p">,</span> <span class="n">CLIPNORM</span> <span class="o">=</span> <span class="n">hdr</span><span class="o">.</span><span class="n">handle_warning_messages</span><span class="p">(</span><span class="n">triangulation_warning</span><span class="p">,</span>
                                            <span class="n">boundary_warning</span><span class="p">,</span> <span class="n">triangulation</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">,</span>
                                            <span class="n">entry1</span><span class="p">,</span> <span class="n">entry4</span><span class="p">,</span> <span class="n">entry5</span><span class="p">,</span> <span class="n">entry6</span><span class="p">,</span> <span class="n">N1</span><span class="p">,</span> <span class="n">N3</span><span class="p">,</span> <span class="n">NTE</span><span class="p">,</span> <span class="n">INI</span><span class="p">,</span> <span class="n">FIN</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_entry_field_labels</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create labels for the entry fields.&quot;&quot;&quot;</span>
        <span class="n">label1</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Cosmological constant:&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
        <span class="n">label2</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Initial boundary:&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
        <span class="n">label3</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Final boundary:&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
        <span class="n">label4</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Epochs:&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
        <span class="n">label5</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Learning rate:&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
        <span class="n">label6</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Clipnorm:&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

        <span class="c1"># Arrange labels in a grid</span>
        <span class="n">label1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">label2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">label3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">label4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">label5</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">label6</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_entry_fields</span><span class="p">(</span><span class="n">compute_button</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate the root window&#39;s entry fields.&quot;&quot;&quot;</span>

        <span class="c1"># Entry field for the value of the cosmological constant</span>
        <span class="n">entry1</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
        <span class="n">entry1</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_CC</span><span class="p">)</span>
        <span class="n">entry1</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusIn&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="n">on_entry1_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">))</span>
        <span class="n">entry1</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusOut&gt;&quot;</span><span class="p">,</span> <span class="n">on_focus_out1</span><span class="p">)</span>

        <span class="c1"># Entry field for the value of the initial boundary</span>
        <span class="n">entry2</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
        <span class="n">entry2</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_EDGE_INI</span><span class="p">)</span>
        <span class="n">entry2</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusIn&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="n">on_entry2_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">))</span>
        <span class="n">entry2</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusOut&gt;&quot;</span><span class="p">,</span> <span class="n">on_focus_out2</span><span class="p">)</span>

        <span class="c1"># Entry field for the value of the final boundary</span>
        <span class="n">entry3</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
        <span class="n">entry3</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_EDGE_FIN</span><span class="p">)</span>
        <span class="n">entry3</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusIn&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="n">on_entry3_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">))</span>
        <span class="n">entry3</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusOut&gt;&quot;</span><span class="p">,</span> <span class="n">on_focus_out3</span><span class="p">)</span>

        <span class="c1"># Entry field for the value of the number of EPOCHS</span>
        <span class="n">entry4</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
        <span class="n">entry4</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_EPOCHS</span><span class="p">)</span>
        <span class="n">entry4</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusIn&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="n">on_entry4_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">))</span>
        <span class="n">entry4</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusOut&gt;&quot;</span><span class="p">,</span> <span class="n">on_focus_out4</span><span class="p">)</span>

        <span class="c1"># Entry field for the value of the learning rate</span>
        <span class="n">entry5</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
        <span class="n">entry5</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_LR</span><span class="p">)</span>
        <span class="n">entry5</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusIn&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="n">on_entry5_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">))</span>
        <span class="n">entry5</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusOut&gt;&quot;</span><span class="p">,</span> <span class="n">on_focus_out5</span><span class="p">)</span>

        <span class="c1"># Entry field for the value of the adam optimizer&#39;s CLIPNORM</span>
        <span class="n">entry6</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
        <span class="n">entry6</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_CLIPNORM</span><span class="p">)</span>
        <span class="n">entry6</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusIn&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="n">on_entry6_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">))</span>
        <span class="n">entry6</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;FocusOut&gt;&quot;</span><span class="p">,</span> <span class="n">on_focus_out6</span><span class="p">)</span>

        <span class="c1"># Arrange entry fields in a grid</span>
        <span class="n">entry1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">entry2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">entry3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">entry4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">entry5</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">entry6</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">entry1</span><span class="p">,</span> <span class="n">entry2</span><span class="p">,</span> <span class="n">entry3</span><span class="p">,</span> <span class="n">entry4</span><span class="p">,</span> <span class="n">entry5</span><span class="p">,</span> <span class="n">entry6</span>

    <span class="k">def</span> <span class="nf">no_steps_chosen</span><span class="p">():</span>
        <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of steps not yet chosen.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_root_buttons</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate the root window&#39;s buttons.&quot;&quot;&quot;</span>

        <span class="c1"># Compute button</span>
        <span class="n">compute_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Compute&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">no_steps_chosen</span><span class="p">())</span>
        <span class="n">compute_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">compute_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span>

        <span class="c1"># Confirm inputs button</span>
        <span class="n">get_inputs_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Confirm choices&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span>
        <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">confirm_choices</span><span class="p">(</span><span class="n">TRIANGULATION_VALUE</span><span class="p">,</span> <span class="n">BOUNDARY_VALUE</span><span class="p">,</span> <span class="n">compute_button</span><span class="p">,</span>
                                        <span class="n">entry1</span><span class="p">,</span> <span class="n">entry2</span><span class="p">,</span> <span class="n">entry3</span><span class="p">,</span> <span class="n">entry4</span><span class="p">,</span> <span class="n">entry5</span><span class="p">,</span> <span class="n">entry6</span><span class="p">))</span>
        <span class="n">get_inputs_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">compute_button</span>

    <span class="k">def</span> <span class="nf">check_for_changes</span><span class="p">(</span><span class="n">entry1</span><span class="p">,</span> <span class="n">entry5</span><span class="p">,</span> <span class="n">entry6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Disable the compoute button upon a change in the triangulation or the boundary data.&quot;&quot;&quot;</span>
        <span class="k">global</span> <span class="n">UPDATED_CONFIG</span><span class="p">,</span> <span class="n">CHANGED_STEPS</span>
        <span class="k">if</span> <span class="n">UPDATED_CONFIG</span><span class="p">:</span>
            <span class="n">UPDATED_CONFIG</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># Disable the compute button upon changing the parameters.</span>
            <span class="n">compute_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">CHANGED_STEPS</span><span class="p">:</span>
                <span class="n">CHANGED_STEPS</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="n">entry1</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">)</span>
                <span class="n">entry1</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_CC</span><span class="p">)</span>
                <span class="n">entry5</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">)</span>
                <span class="n">entry5</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_LR</span><span class="p">)</span>
                <span class="n">entry6</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">)</span>
                <span class="n">entry6</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_CLIPNORM</span><span class="p">)</span>

        <span class="c1"># Check every 0.2 seconds for changes</span>
        <span class="n">root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">check_for_changes</span><span class="p">(</span><span class="n">entry1</span><span class="p">,</span> <span class="n">entry5</span><span class="p">,</span> <span class="n">entry6</span><span class="p">))</span>

    <span class="c1"># Generate and set the buttons of the root window</span>
    <span class="n">compute_button</span> <span class="o">=</span> <span class="n">generate_root_buttons</span><span class="p">()</span>

    <span class="c1"># Generate and set the entry field labels of the root window</span>
    <span class="n">generate_entry_field_labels</span><span class="p">()</span>

    <span class="c1"># Generate and set the entry fields of the root window</span>
    <span class="n">entry1</span><span class="p">,</span> <span class="n">entry2</span><span class="p">,</span> <span class="n">entry3</span><span class="p">,</span> <span class="n">entry4</span><span class="p">,</span> <span class="n">entry5</span><span class="p">,</span> <span class="n">entry6</span> <span class="o">=</span> <span class="n">generate_entry_fields</span><span class="p">(</span><span class="n">compute_button</span><span class="p">)</span>

    <span class="c1"># Force the user to save his changes before entering the next computation</span>
    <span class="c1">#root.after(100, check_for_changes)</span>
    <span class="n">root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">check_for_changes</span><span class="p">(</span><span class="n">entry1</span><span class="p">,</span> <span class="n">entry5</span><span class="p">,</span> <span class="n">entry6</span><span class="p">))</span>

    <span class="c1"># Run the Tkinter event loop</span>
    <span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span></div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../documentation.html">FLRW-Net 2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">user_interface</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Florian Emanuel Hilpert.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>
  </body>
</html>